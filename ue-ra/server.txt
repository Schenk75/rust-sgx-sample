[+] Init Enclave Successful 2!
Running as server...
new client from 127.0.0.1:33194
Entering ocall_sgx_init_quote
eg = [201, 10, 0, 0]
get_sigrl_from_intel fd = 7
GET /sgx/dev/attestation/v3/sigrl/00000ac9 HTTP/1.1
HOST: api.trustedservices.intel.com
Ocp-Apim-Subscription-Key: a1790cf4c3a645ea9d734cf6cddce5f3
Connection: Close


write complete
read_to_end complete
HTTP/1.1 200 OK
Content-Length: 0
Request-ID: 31239c6280f54763b865a4e24faf0237
Date: Tue, 30 Mar 2021 11:49:41 GMT
Connection: close


parse_response_sigrl
parse result Ok(Complete(140))
parse responseResponse { version: Some(1), code: Some(200), reason: Some("OK"), headers: [Header { name: "Content-Length", value: [48] }, Header { name: "Request-ID", value: [51, 49, 50, 51, 57, 99, 54, 50, 56, 48, 102, 53, 52, 55, 54, 51, 98, 56, 54, 53, 97, 52, 101, 50, 52, 102, 97, 102, 48, 50, 51, 55] }, Header { name: "Date", value: [84, 117, 101, 44, 32, 51, 48, 32, 77, 97, 114, 32, 50, 48, 50, 49, 32, 49, 49, 58, 52, 57, 58, 52, 49, 32, 71, 77, 84] }, Header { name: "Connection", value: [99, 108, 111, 115, 101] }] }
OK Operation Successful
Report creation => success [131, 215, 25, 231, 125, 234, 202, 20, 112, 246, 186, 246, 42, 77, 119, 67, 3, 200, 153, 219, 105, 2, 15, 156, 112, 238, 29, 252, 8, 199, 206, 158]
rand finished
Entering ocall_get_quote
quote size = 1116
sgx_calc_quote_size returned SGX_SUCCESS.
rsgx_verify_report passed!
qe_report check passed
rhs hash = FD8ECB9D3FD89C93BE9DDB6580062F6984AD69EEBC38A3E93455C32F6162BB3E
report hs= FD8ECB9D3FD89C93BE9DDB6580062F6984AD69EEBC38A3E93455C32F6162BB3E
get_report_from_intel fd = 7
POST /sgx/dev/attestation/v3/report HTTP/1.1
HOST: api.trustedservices.intel.com
Ocp-Apim-Subscription-Key:a1790cf4c3a645ea9d734cf6cddce5f3
Content-Length:1512
Content-Type: application/json
Connection: close

{"isvEnclaveQuote":"AgABAMkKAAALAAoAAAAAABjXJMzAoX9P70dp7BBkzUcAAAAAAAAAAAAAAAAAAAAABRH/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAHAAAAAAAAAALaC6ShWiTsqWFCX2ssarQAiNmSYbJ8P90yIGc0wZfnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACD1xnnferKFHD2uvYqTXdDA8iZ22kCD5xw7h38CMfOngAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABV7YptIpGTBKaEbAK+ZL8odWK49F2HJRUJBYAYTHBpwYjlz85QfyNxVfElMGq+BPVNrcPesaICaLODud722LKwqAIAAJeKcA4rGp4939k7vyfgJhjVOg9H0syAqN9uFIC7EiH5aoSaSSZ3ep85VneZMsxpzjDKnnFgGmdtWd1tlP8nbjt6zn5AxtghcW653EkNMO5liQijkvuGXafLowKTHbYYjMpQCeUW8NCqDhQZdYMjsAXnfsSIqXzvdXmZw1dd0U639zNaVbowkoSBEPBPc+BZZDCCWhMnIpOf7vO6HUGvlC3bxv+//O/uwA/fYuCw5cd936Iy/jG9ShauXBOHXux97q2Y7h+HKGnDz87i7i71EsCEUAGmunU6/G7HHV/e9s4w3LAaoKkavDUR3OIK866dv4qWq7wIzBqIYBP49BqvAlkmKB2pBA+76VBP46dOzh19nNyJ4QUqDmgTbWj39gB0h4EZIMcGIEuoL0zkTWgBAAD2AYm/CcChfgnE2s2y3S2s8f33GVIUdTzTcaxBTyoT6aNF8aI+/8g6q7OzKTBhaT6Du9GnPbmI8saY6yVZsIYa8qJepGSOhNRVNogcWqcJ+Yf0c1SNm08Qe1QV2TQfKtXu1IoJDvJjPftxWJ4ZF9A4tPx0o3IXV8nUUl7PmaXHeCiaGwUeizUZytSBP+Onnxj7pC2PSr/yAREMl4ACNJfkF3Qtv3TJHjHG+mSt0FkXOV5mo7+S1jfjIf2gs8yq4ArzF8xuc/MvccviPAqBq42I3h6wBiRqj7CjIH1MLSHiZsY7zgviMBjNfsmPEhcyYfASZHNZEaK9UA/Gz/R6Tldq4m3nvM0jLm6xmUMvFbCzOarUmRK0fFHXIyPVsjw3yzgtjYhSLZeNr2hSqd2UnQFd4XfK9XSJyw0yWFTRBiC+ypGz72GTT/jmJE8qyL5LIlnjqTlIxb2oG+VtBq5sTTMjKNpcNE5EY/cqdoh+R8JRgx1jQjXnfZnu"}

write complete
read_to_end complete
resp_string = HTTP/1.1 200 OK
Content-Length: 1169
Content-Type: application/json
Request-ID: ab0125caa8ad4291b80d989b1ec67556
Advisory-URL: https://security-center.intel.com
Advisory-IDs: INTEL-SA-00381,INTEL-SA-00389,INTEL-SA-00320,INTEL-SA-00329,INTEL-SA-00220,INTEL-SA-00270,INTEL-SA-00293,INTEL-SA-00233,INTEL-SA-00203,INTEL-SA-00106,INTEL-SA-00115,INTEL-SA-00135,INTEL-SA-00088
X-IASReport-Signature: my6xF4zii1XD7B01BTvSbttSnUJQhMHF9m3b/fo092OxZwj9tZm8pHlf3kqDw6MKy3BRmi27ZYpgg+sEmLqkEV2ccQtyGvUuZW9wZ1NXDzRB4x4h4n0jdWu5FSv6AC3L8lhdfM+q/qOttZpCYLjweKxcyjzx03F9txbspvxCEK6+J0z/bxH2XL9L1iiZKPmizwAtBKxeeYwjZM3aQZwLZwSZ2Xr4LDcAEGXBiyv/kKmTMI+IR+ptv5q6Mi13okjzfj8M10ImRngvRBivG6CeWVa05eovVI5kVeV8ZnSHkbS8x/C+P7dOfZRFGKs6kawA6HyMk9h60RFUWIgAh/483w==
X-IASReport-Signing-Certificate: -----BEGIN%20CERTIFICATE-----%0AMIIEoTCCAwmgAwIBAgIJANEHdl0yo7CWMA0GCSqGSIb3DQEBCwUAMH4xCzAJBgNV%0ABAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UEBwwLU2FudGEgQ2xhcmExGjAYBgNV%0ABAoMEUludGVsIENvcnBvcmF0aW9uMTAwLgYDVQQDDCdJbnRlbCBTR1ggQXR0ZXN0%0AYXRpb24gUmVwb3J0IFNpZ25pbmcgQ0EwHhcNMTYxMTIyMDkzNjU4WhcNMjYxMTIw%0AMDkzNjU4WjB7MQswCQYDVQQGEwJVUzELMAkGA1UECAwCQ0ExFDASBgNVBAcMC1Nh%0AbnRhIENsYXJhMRowGAYDVQQKDBFJbnRlbCBDb3Jwb3JhdGlvbjEtMCsGA1UEAwwk%0ASW50ZWwgU0dYIEF0dGVzdGF0aW9uIFJlcG9ydCBTaWduaW5nMIIBIjANBgkqhkiG%0A9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqXot4OZuphR8nudFrAFiaGxxkgma/Es/BA%2Bt%0AbeCTUR106AL1ENcWA4FX3K%2BE9BBL0/7X5rj5nIgX/R/1ubhkKWw9gfqPG3KeAtId%0Acv/uTO1yXv50vqaPvE1CRChvzdS/ZEBqQ5oVvLTPZ3VEicQjlytKgN9cLnxbwtuv%0ALUK7eyRPfJW/ksddOzP8VBBniolYnRCD2jrMRZ8nBM2ZWYwnXnwYeOAHV%2BW9tOhA%0AImwRwKF/95yAsVwd21ryHMJBcGH70qLagZ7Ttyt%2B%2BqO/6%2BKAXJuKwZqjRlEtSEz8%0AgZQeFfVYgcwSfo96oSMAzVr7V0L6HSDLRnpb6xxmbPdqNol4tQIDAQABo4GkMIGh%0AMB8GA1UdIwQYMBaAFHhDe3amfrzQr35CN%2Bs1fDuHAVE8MA4GA1UdDwEB/wQEAwIG%0AwDAMBgNVHRMBAf8EAjAAMGAGA1UdHwRZMFcwVaBToFGGT2h0dHA6Ly90cnVzdGVk%0Ac2VydmljZXMuaW50ZWwuY29tL2NvbnRlbnQvQ1JML1NHWC9BdHRlc3RhdGlvblJl%0AcG9ydFNpZ25pbmdDQS5jcmwwDQYJKoZIhvcNAQELBQADggGBAGcIthtcK9IVRz4r%0ARq%2BZKE%2B7k50/OxUsmW8aavOzKb0iCx07YQ9rzi5nU73tME2yGRLzhSViFs/LpFa9%0AlpQL6JL1aQwmDR74TxYGBAIi5f4I5TJoCCEqRHz91kpG6Uvyn2tLmnIdJbPE4vYv%0AWLrtXXfFBSSPD4Afn7%2B3/XUggAlc7oCTizOfbbtOFlYA4g5KcYgS1J2ZAeMQqbUd%0AZseZCcaZZZn65tdqee8UXZlDvx0%2BNdO0LR%2B5pFy%2BjuM0wWbu59MvzcmTXbjsi7HY%0A6zd53Yq5K244fwFHRQ8eOB0IWB%2B4PfM7FeAApZvlfqlKOlLcZL2uyVmzRkyR5yW7%0A2uo9mehX44CiPJ2fse9Y6eQtcfEhMPkmHXI01sN%2BKwPbpA39%2BxOsStjhP9N1Y1a2%0AtQAVo%2ByVgLgV2Hws73Fc0o3wC78qPEA%2Bv2aRs/Be3ZFDgDyghc/1fgU%2B7C%2BP6kbq%0Ad4poyb6IW8KCJbxfMJvkordNOgOUUxndPHEi/tb/U7uLjLOgPA%3D%3D%0A-----END%20CERTIFICATE-----%0A-----BEGIN%20CERTIFICATE-----%0AMIIFSzCCA7OgAwIBAgIJANEHdl0yo7CUMA0GCSqGSIb3DQEBCwUAMH4xCzAJBgNV%0ABAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UEBwwLU2FudGEgQ2xhcmExGjAYBgNV%0ABAoMEUludGVsIENvcnBvcmF0aW9uMTAwLgYDVQQDDCdJbnRlbCBTR1ggQXR0ZXN0%0AYXRpb24gUmVwb3J0IFNpZ25pbmcgQ0EwIBcNMTYxMTE0MTUzNzMxWhgPMjA0OTEy%0AMzEyMzU5NTlaMH4xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UEBwwL%0AU2FudGEgQ2xhcmExGjAYBgNVBAoMEUludGVsIENvcnBvcmF0aW9uMTAwLgYDVQQD%0ADCdJbnRlbCBTR1ggQXR0ZXN0YXRpb24gUmVwb3J0IFNpZ25pbmcgQ0EwggGiMA0G%0ACSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQCfPGR%2BtXc8u1EtJzLA10Feu1Wg%2Bp7e%0ALmSRmeaCHbkQ1TF3Nwl3RmpqXkeGzNLd69QUnWovYyVSndEMyYc3sHecGgfinEeh%0ArgBJSEdsSJ9FpaFdesjsxqzGRa20PYdnnfWcCTvFoulpbFR4VBuXnnVLVzkUvlXT%0AL/TAnd8nIZk0zZkFJ7P5LtePvykkar7LcSQO85wtcQe0R1Raf/sQ6wYKaKmFgCGe%0ANpEJUmg4ktal4qgIAxk%2BQHUxQE42sxViN5mqglB0QJdUot/o9a/V/mMeH8KvOAiQ%0AbyinkNndn%2BBgk5sSV5DFgF0DffVqmVMblt5p3jPtImzBIH0QQrXJq39AT8cRwP5H%0AafuVeLHcDsRp6hol4P%2BZFIhu8mmbI1u0hH3W/0C2BuYXB5PC%2B5izFFh/nP0lc2Lf%0A6rELO9LZdnOhpL1ExFOq9H/B8tPQ84T3Sgb4nAifDabNt/zu6MmCGo5U8lwEFtGM%0ARoOaX4AS%2B909x00lYnmtwsDVWv9vBiJCXRsCAwEAAaOByTCBxjBgBgNVHR8EWTBX%0AMFWgU6BRhk9odHRwOi8vdHJ1c3RlZHNlcnZpY2VzLmludGVsLmNvbS9jb250ZW50%0AL0NSTC9TR1gvQXR0ZXN0YXRpb25SZXBvcnRTaWduaW5nQ0EuY3JsMB0GA1UdDgQW%0ABBR4Q3t2pn680K9%2BQjfrNXw7hwFRPDAfBgNVHSMEGDAWgBR4Q3t2pn680K9%2BQjfr%0ANXw7hwFRPDAOBgNVHQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADANBgkq%0AhkiG9w0BAQsFAAOCAYEAeF8tYMXICvQqeXYQITkV2oLJsp6J4JAqJabHWxYJHGir%0AIEqucRiJSSx%2BHjIJEUVaj8E0QjEud6Y5lNmXlcjqRXaCPOqK0eGRz6hi%2BripMtPZ%0AsFNaBwLQVV905SDjAzDzNIDnrcnXyB4gcDFCvwDFKKgLRjOB/WAqgscDUoGq5ZVi%0AzLUzTqiQPmULAQaB9c6Oti6snEFJiCQ67JLyW/E83/frzCmO5Ru6WjU4tmsmy8Ra%0AUd4APK0wZTGtfPXU7w%2BIBdG5Ez0kE1qzxGQaL4gINJ1zMyleDnbuS8UicjJijvqA%0A152Sq049ESDz%2B1rRGc2NVEqh1KaGXmtXvqxXcTB%2BLjy5Bw2ke0v8iGngFBPqCTVB%0A3op5KBG3RjbF6RRSzwzuWfL7QErNC8WEy5yDVARzTA5%2BxmBc388v9Dm21HGfcC8O%0ADD%2BgT9sSpssq0ascmvH49MOgjt1yoysLtdCtJW/9FZpoOypaHx0R%2BmJTLwPXVMrv%0ADaVzWh5aiEx%2BidkSGMnX%0A-----END%20CERTIFICATE-----%0A
Date: Tue, 30 Mar 2021 11:49:43 GMT
Connection: close

{"id":"143907353227611488731688748667804827238","timestamp":"2021-03-30T11:49:43.723648","version":3,"epidPseudonym":"mMqrHF1zVv/25u2Yo6kds/4NBT7rGSfBAF3PwwfzyDNiqG5Xnv1eA3/PDQ1bVpIraEtZqAFsMvtjoLfciLKhGY+6yBwyite6aHFY/XbS0jNs1Z87bCSjHmRM6MD2izxQYDjIIH8BF6wsolOacmwW9CCcRTvxWtb/+woLKRR7aEo=","isvEnclaveQuoteStatus":"GROUP_OUT_OF_DATE","platformInfoBlob":"150200650400010000111102040101070000000000000000000B00000B000000020000000000000AC9B43B41724A0C17784B9C870B3A60FBF419C6F55F13461D4C1D5226EB03AEB5174D2808A0BD7065E8F97C9DFDF5010F80D830F1E808A60ACFB2BED9CB376538B8","isvEnclaveQuoteBody":"AgABAMkKAAALAAoAAAAAABjXJMzAoX9P70dp7BBkzUcAAAAAAAAAAAAAAAAAAAAABRH/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAHAAAAAAAAAALaC6ShWiTsqWFCX2ssarQAiNmSYbJ8P90yIGc0wZfnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACD1xnnferKFHD2uvYqTXdDA8iZ22kCD5xw7h38CMfOngAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABV7YptIpGTBKaEbAK+ZL8odWK49F2HJRUJBYAYTHBpwYjlz85QfyNxVfElMGq+BPVNrcPesaICaLODud722LKw"}
parse_response_attn_report
parse result Ok(Complete(4604))
OK Operation Successful
content length = 1169
Attestation report: {"id":"143907353227611488731688748667804827238","timestamp":"2021-03-30T11:49:43.723648","version":3,"epidPseudonym":"mMqrHF1zVv/25u2Yo6kds/4NBT7rGSfBAF3PwwfzyDNiqG5Xnv1eA3/PDQ1bVpIraEtZqAFsMvtjoLfciLKhGY+6yBwyite6aHFY/XbS0jNs1Z87bCSjHmRM6MD2izxQYDjIIH8BF6wsolOacmwW9CCcRTvxWtb/+woLKRR7aEo=","isvEnclaveQuoteStatus":"GROUP_OUT_OF_DATE","platformInfoBlob":"150200650400010000111102040101070000000000000000000B00000B000000020000000000000AC9B43B41724A0C17784B9C870B3A60FBF419C6F55F13461D4C1D5226EB03AEB5174D2808A0BD7065E8F97C9DFDF5010F80D830F1E808A60ACFB2BED9CB376538B8","isvEnclaveQuoteBody":"AgABAMkKAAALAAoAAAAAABjXJMzAoX9P70dp7BBkzUcAAAAAAAAAAAAAAAAAAAAABRH/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAHAAAAAAAAAALaC6ShWiTsqWFCX2ssarQAiNmSYbJ8P90yIGc0wZfnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACD1xnnferKFHD2uvYqTXdDA8iZ22kCD5xw7h38CMfOngAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABV7YptIpGTBKaEbAK+ZL8odWK49F2HJRUJBYAYTHBpwYjlz85QfyNxVfElMGq+BPVNrcPesaICaLODud722LKw"}
Client said: hello
ECALL success!
[+] Done!
